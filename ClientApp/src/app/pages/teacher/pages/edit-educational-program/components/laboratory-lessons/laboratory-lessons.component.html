
<div class="spinner__wrapper" *ngIf="(spinnerService.isSpinnerWork | async)">
  <app-spinner [name]="laboratoryLayerSpinner"></app-spinner>
</div>
<div
  class="laboratory-lessons-layer layer"
  *ngIf="!(spinnerService.isSpinnerWork | async)"
>
  <div class="laboratory-lessons-header header">
    <div class="laboratory-lessons-header-title header-title">
      <span class="title__item">Лабораторные</span>
    </div>
    <div class="laboratory-lessons-header-buttons">
      <button
        mat-raised-button
        class="mr-15"
        [disabled]="isDisable"
        (click)="addEmptyLesson()"
      >
        Добавить
      </button>
    </div>
  </div>

  <div class="laboratory-lessons-layer-content" *ngIf="(dataSource | async)?.length === 0">
    <span>Нет данных</span>
  </div>

  <div
    class="laboratory-lessons-layer-content"
    *ngIf="(dataSource | async)?.length !== 0"
  >
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
      <ng-container matColumnDef="number">
        <th mat-header-cell *matHeaderCellDef>Номер</th>
        <td mat-cell *matCellDef="let element">
          <span>{{ element.number }}</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Название</th>
        <td mat-cell *matCellDef="let element" [formGroup]="form">
          <ng-container *ngIf="element.isEdit">
            <input
              type="text"
              formControlName="name"
              class="form-control"
              placeholder="Введите описание"
            />
          </ng-container>

          <ng-container *ngIf="!element.isEdit">
            <span>{{ element.name }}</span>
          </ng-container>
        </td>
      </ng-container>

      <ng-container matColumnDef="hours">
        <th mat-header-cell *matHeaderCellDef>Часов</th>
        <td
          mat-cell
          *matCellDef="let element; let i = index"
          [formGroup]="form"
        >
          <ng-container *ngIf="element.isEdit">
            <input
              type="number"
              formControlName="hours"
              class="form-control"
              placeholder="Введите количество часов"
            />
          </ng-container>

          <ng-container *ngIf="!element.isEdit">
            <span>{{ element.hours }}</span>
          </ng-container>
        </td>
      </ng-container>

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef>Действия</th>
        <td mat-cell *matCellDef="let element; let i = index">
          <ng-container *ngIf="!element.isEdit">
            <fa-icon
              [icon]="faPencil"
              class="text-info cursor-pointer mr-3"
              (click)="enableEditing(element)"
            ></fa-icon>
            <fa-icon
              [icon]="faTrash"
              class="text-danger cursor-pointer"
              (click)="openModal(popup, element.id)"
            ></fa-icon>
          </ng-container>

          <ng-container *ngIf="element.isEdit">
            <fa-icon
              [icon]="faCheck"
              class="text-success cursor-pointer mr-3"
              (click)="updateLesson()"
            ></fa-icon>
            <fa-icon
              [icon]="faTimes"
              class="text-danger cursor-pointer"
              (click)="cancelEditing()"
            ></fa-icon>
          </ng-container>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
</div>

<ng-template #popup let-d="dismiss">
  <div class="modal-body text-center">
    <h4 class="mb-4">
      Are you sure, you want to delete this employee details?
    </h4>
    <button
      class="btn btn-primary btn-sm pl-4 pr-4 mr-2"
      (click)="deleteLesson(); d()"
    >
      Yes
    </button>
    <button class="btn btn-secondary btn-sm pl-4 pr-4 ml-2" (click)="d()">
      No
    </button>
  </div>
</ng-template>
